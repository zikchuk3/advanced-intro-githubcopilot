
## Security Vulnerability Hunt & Fix Feature

### Objective
Identify and fix security vulnerabilities in provided vulnerable Python Flask code using Copilot assistance.

### Prerequisites
- Vulnerable Flask starter code provided by instructor
- Basic understanding of web security concepts

### Step-by-Step Instructions

**Step 1: Security Audit Setup**
1. Add security packages to `requirements.txt`:
   ```
   Flask-Limiter==3.5.0
   Flask-Talisman==1.1.0
   bcrypt==4.0.1
   Flask-WTF==1.1.1
   ```

2. Install packages: `pip install -r requirements.txt`

3. Use Copilot prompt: `# Set up basic security middleware for Flask app with Talisman and rate limiting`

**Step 2: Identify SQL Injection Vulnerabilities**
1. Find database queries in the provided vulnerable code
2. Prompt Copilot: `# Fix this SQL injection vulnerability in user login using SQLAlchemy parameterized queries`
3. Replace raw SQL strings with parameterized statements:
   ```python
   # Convert this vulnerable query to SQLAlchemy safe query
   ```
4. Add input validation: `# Validate and sanitize user input for database queries using WTForms`

**Step 3: Fix Cross-Site Scripting (XSS)**
1. Locate user input rendering points in Jinja2 templates
2. Use Copilot: `# Sanitize user input to prevent XSS attacks in Flask templates`
3. Implement Content Security Policy headers:
   ```python
   # Add CSP headers using Flask-Talisman to prevent XSS
   ```
4. Fix template rendering: `<!-- Escape user input properly in Jinja2 templates -->`

**Step 4: Implement Authentication Security**
1. Prompt Copilot: `# Create secure password hashing with bcrypt in Flask`
2. Add session management: `# Implement secure session handling with Flask session and CSRF protection`
3. Set up password complexity requirements:
   ```python
   # Create password validation function with complexity requirements
   ```
4. Implement account lockout: `# Add account lockout after failed login attempts`

**Step 5: Add Security Headers and Middleware**
1. Use Copilot: `# Add all essential security headers for Flask app using Talisman`
2. Implement rate limiting: `# Create rate limiting for Flask API endpoints using Flask-Limiter`
3. Add CORS configuration: `# Configure secure CORS headers for Flask app`

**Step 6: Final Security Review**
1. Use Copilot to review: `# Security checklist for this Flask web application`
2. Test security fixes with sample payloads
3. Verify all headers are properly set
